<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.jenitennison.com/xslt/xspec"
        xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/c-to-fhir-utility-Root.xspec"
        stylesheet="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/SaxonPE-cda2fhir.xslt"
        date="2022-01-04T15:28:45.146428+10:00">
   <scenario id="scenario1"
             xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/c-to-fhir-utility-Root.xspec">
      <label>Scenario for testing template 'author-reference'</label>
      <input-wrap xmlns="">
         <x:context xmlns:cda="urn:hl7-org:v3"
                    xmlns:fhir="http://hl7.org/fhir"
                    xmlns:lcg="http://www.lantanagroup.com"
                    xmlns:x="http://www.jenitennison.com/xslt/xspec"
                    href="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/samples/cda/eICR-R3/eICR-CDA-001_R3.xml"/>
      </input-wrap>
      <input-wrap xmlns="">
         <x:call xmlns:cda="urn:hl7-org:v3"
                 xmlns:fhir="http://hl7.org/fhir"
                 xmlns:lcg="http://www.lantanagroup.com"
                 xmlns:x="http://www.jenitennison.com/xslt/xspec"
                 template="author-reference">
            <x:param name="pElementName">performer</x:param>
            <x:param name="pPractitionerRole" select="true()"/>
         </x:call>
      </input-wrap>
      <result select="/element()">
         <content-wrap xmlns="">
            <performer xmlns="http://hl7.org/fhir">
               <reference value="urn:uuid:"/>
            </performer>
         </content-wrap>
      </result>
      <test id="scenario1-expect1" successful="true">
         <label>There should be a performer</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:performer) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
   </scenario>
   <scenario id="scenario2"
             xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/c-to-fhir-utility-Root.xspec">
      <label>Scenario for testing template with match 'cda:doseQuantity</label>
      <input-wrap xmlns="">
         <x:context xmlns:cda="urn:hl7-org:v3"
                    xmlns:fhir="http://hl7.org/fhir"
                    xmlns:lcg="http://www.lantanagroup.com"
                    xmlns:x="http://www.jenitennison.com/xslt/xspec">
            <x:param name="pElementName">doseQuantity</x:param>
            <x:param name="pSimpleQuantity" select="false()"/>
            <cda:doseQuantity value="1" unit="g"/>
         </x:context>
      </input-wrap>
      <result select="/element()">
         <content-wrap xmlns="">
            <doseQuantity xmlns="http://hl7.org/fhir">
               <value value="1"/>
               <unit value="g"/>
            </doseQuantity>
         </content-wrap>
      </result>
      <test id="scenario2-expect1" successful="true">
         <label>There should be a doseQuantity with value = '1' and unit = 'g'</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:doseQuantity[fhir:value/@value='1'][fhir:unit/@value='g'])=1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
   </scenario>
   <scenario id="scenario3"
             xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/c-to-fhir-utility-Root.xspec">
      <label>Scenario for testing template with match 'cda:doseQuantity' value nullFlavor and NOT simpleQuantity data type</label>
      <input-wrap xmlns="">
         <x:context xmlns:cda="urn:hl7-org:v3"
                    xmlns:fhir="http://hl7.org/fhir"
                    xmlns:lcg="http://www.lantanagroup.com"
                    xmlns:x="http://www.jenitennison.com/xslt/xspec">
            <x:param name="pElementName">doseQuantity</x:param>
            <x:param name="pSimpleQuantity" select="false()"/>
            <cda:doseQuantity nullFlavor="NI"/>
         </x:context>
      </input-wrap>
      <result select="/element()">
         <content-wrap xmlns="">
            <doseQuantity xmlns="http://hl7.org/fhir">
               <code value="NoInformation"/>
               <system value="http://terminology.hl7.org/CodeSystem/v3-NullFlavor"/>
            </doseQuantity>
         </content-wrap>
      </result>
      <test id="scenario3-expect1" successful="true">
         <label>There should be a doseQuantity with nullFlavor='NoInformation'</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:doseQuantity[fhir:code/@value='NoInformation'][fhir:system/@value='http://terminology.hl7.org/CodeSystem/v3-NullFlavor'])=1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
   </scenario>
   <scenario id="scenario4"
             xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/c-to-fhir-utility-Root.xspec">
      <label>Scenario for testing cda:telecom</label>
      <input-wrap xmlns="">
         <x:context xmlns:cda="urn:hl7-org:v3"
                    xmlns:fhir="http://hl7.org/fhir"
                    xmlns:lcg="http://www.lantanagroup.com"
                    xmlns:x="http://www.jenitennison.com/xslt/xspec">
            <cda:telecom use="HP" value="tel:+1-555-555-2006"/>
            <cda:telecom use="WP" value="tel:+1-(555)555-1212;ext=9998"/>
            <cda:telecom use="WP" value="fax:+1(555)555-1234"/>
            <cda:telecom value="mailto:mail@guardian.com"/>
            <cda:telecom use="WP" value="https://www.healthauthoritywest.gov"/>
         </x:context>
      </input-wrap>
      <result select="/element()">
         <content-wrap xmlns="">
            <telecom xmlns="http://hl7.org/fhir">
               <system value="phone"/>
               <value value="+1-555-555-2006"/>
               <use value="home"/>
            </telecom>
            <telecom xmlns="http://hl7.org/fhir">
               <system value="phone"/>
               <value value="+1-(555)555-1212;ext=9998"/>
               <use value="work"/>
            </telecom>
            <telecom xmlns="http://hl7.org/fhir">
               <system value="fax"/>
               <value value="+1(555)555-1234"/>
               <use value="work"/>
            </telecom>
            <telecom xmlns="http://hl7.org/fhir">
               <system value="email"/>
               <value value="mail@guardian.com"/>
            </telecom>
            <telecom xmlns="http://hl7.org/fhir">
               <system value="url"/>
               <value value="https://www.healthauthoritywest.gov"/>
               <use value="work"/>
            </telecom>
         </content-wrap>
      </result>
      <test id="scenario4-expect1" successful="true">
         <label>Should produce 5 telecoms</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:telecom) = 5"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario4-expect2" successful="true">
         <label>Should produce 2 'phone' telecom</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:telecom/fhir:system[@value='phone']) = 2"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario4-expect3" successful="true">
         <label>Should produce 1 home 'phone' telecom</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:telecom[fhir:system[@value='phone']]/fhir:use[@value='home']) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario4-expect4" successful="true">
         <label>Should produce 1 work 'phone' telecom</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:telecom[fhir:system[@value='phone']]/fhir:use[@value='work']) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario4-expect5" successful="true">
         <label>Should produce 1 'fax' telecom</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:telecom/fhir:system[@value='fax']) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario4-expect6" successful="true">
         <label>Should produce 1 'email' telecom</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:telecom/fhir:system[@value='email']) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario4-expect7" successful="true">
         <label>Should produce 1 'uri' telecom</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:telecom/fhir:system[@value='url']) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
   </scenario>
</report>
