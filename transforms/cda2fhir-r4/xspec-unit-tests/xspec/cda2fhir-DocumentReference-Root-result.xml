<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.jenitennison.com/xslt/xspec"
        xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/cda2fhir-DocumentReference-Root.xspec"
        stylesheet="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/SaxonPE-cda2fhir.xslt"
        date="2022-01-04T15:29:16.116903+10:00">
   <scenario id="scenario1"
             xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/cda2fhir-DocumentReference-Root.xspec">
      <label>Scenario for testing template with match 'cda:externalDocument</label>
      <input-wrap xmlns="">
         <x:context xmlns:cda="urn:hl7-org:v3"
                    xmlns:fhir="http://hl7.org/fhir"
                    xmlns:lcg="http://www.lantanagroup.com"
                    xmlns:x="http://www.jenitennison.com/xslt/xspec"
                    href="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/samples/cda/RR-R1/RR-CDA-001_R1.xml"/>
      </input-wrap>
      <result href="result-d243e0.xml"/>
      <test id="scenario1-expect1" successful="true">
         <label>Should produce a DocumentReference: http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference/fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference']) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario1-expect2" successful="true">
         <label>Should produce a DocumentReference/masterIdentifier/system/@value</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference']]/fhir:masterIdentifier/fhir:system[@value='urn:ietf:rfc:3986'])= 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario1-expect3" successful="true">
         <label>Should produce a DocumentReference/masterIdentifier/value/@value='urn:uuid:db734647-fc99-424c-a864-7e3cda82e703'</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference']]/fhir:masterIdentifier/fhir:value[@value='urn:uuid:db734647-fc99-424c-a864-7e3cda82e703'])= 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario1-expect4" successful="true">
         <label>Should produce a DocumentReference/identifier/system/@value</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference']]/fhir:identifier/fhir:system[@value='urn:oid:2.16.840.1.113883.19.5.99999.19'])= 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario1-expect5" successful="true">
         <label>Should produce a DocumentReference/identifier/value.value='urn:uuid:db734647-fc99-424c-a864-7e3cda82e703'</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference']]/fhir:identifier/fhir:value[@value='sTT988#1'])= 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario1-expect6" successful="true">
         <label>Should produce an identifer with status.value='current'</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference']]/fhir:status[@value='current']) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario1-expect7" successful="true">
         <label>Should produce a type.coding.system=http://loinc.org</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference']]/fhir:type/fhir:coding/fhir:system[@value='http://loinc.org']) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario1-expect8" successful="true">
         <label>Should produce a type.coding.code=55751-2</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference']]/fhir:type/fhir:coding/fhir:code[@value='55751-2']) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario1-expect9" successful="true">
         <label>Should produce a type.coding.display=Public health Case report</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference']]/fhir:type/fhir:coding/fhir:display[@value='Public health Case report']) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario1-expect10" successful="true">
         <label>Should produce a category</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference']]/fhir:category) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario1-expect11" successful="true">
         <label>Should produce a content.attachment with url: urn:hl7ii:2.16.840.1.113883.19.5.99999.19:1</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/core/StructureDefinition/us-core-documentreference']]/fhir:content/fhir:attachment/fhir:url[@value='urn:hl7ii:2.16.840.1.113883.19.5.99999.19:1']) = 1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
   </scenario>
   <scenario id="scenario2"
             xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/cda2fhir-DocumentReference-Root.xspec">
      <label>Scenario for testing DocumentReference from 2.16.840.1.113883.10.20.15.2.3.17 RR External Reference (also pulls data from containing RR External Resource template)</label>
      <input-wrap xmlns="">
         <x:context xmlns:cda="urn:hl7-org:v3"
                    xmlns:fhir="http://hl7.org/fhir"
                    xmlns:lcg="http://www.lantanagroup.com"
                    xmlns:x="http://www.jenitennison.com/xslt/xspec"
                    href="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/samples/cda/RR-R1/RR-CDA-001_R1.xml"/>
      </input-wrap>
      <result href="result-d468e0.xml"/>
      <test id="scenario2-expect1" successful="true">
         <label>Should produce 11 DocumentReference: http://hl7.org/fhir/us/ecr/StructureDefinition/rr-documentreference</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference/fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/ecr/StructureDefinition/rr-documentreference']) = 11"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario2-expect2" successful="true">
         <label>Should produce 11 http://hl7.org/fhir/us/ecr/StructureDefinition/rr-priority-extension extensions</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/ecr/StructureDefinition/rr-documentreference']]/fhir:extension[@url='http://hl7.org/fhir/us/ecr/StructureDefinition/rr-priority-extension']) = 11"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario2-expect3" successful="true">
         <label>Should produce 11 status.value='current'</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/ecr/StructureDefinition/rr-documentreference']]/fhir:status[@value='current']) = 11"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario2-expect4" successful="true">
         <label>Should produce 11 type.coding.system=http://loinc.org</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/ecr/StructureDefinition/rr-documentreference']]/fhir:type/fhir:coding/fhir:system[@value='http://loinc.org']) = 11"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario2-expect5" successful="true">
         <label>Should produce 11 type.coding.code=83910-0</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/ecr/StructureDefinition/rr-documentreference']]/fhir:type/fhir:coding/fhir:code[@value='83910-0']) = 11"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario2-expect6" successful="true">
         <label>Should produce 11 type.coding.display=Public health Note</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/ecr/StructureDefinition/rr-documentreference']]/fhir:type/fhir:coding/fhir:display[@value='Public health Note']) = 11"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario2-expect7" successful="true">
         <label>Should produce 11 category</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/ecr/StructureDefinition/rr-documentreference']]/fhir:category) = 11"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario2-expect8" successful="true">
         <label>Should produce 11 description</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/ecr/StructureDefinition/rr-documentreference']]/fhir:description) = 11"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
      <test id="scenario2-expect9" successful="true">
         <label>Should produce 11 content.attachment</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(//fhir:DocumentReference[fhir:meta/fhir:profile[@value='http://hl7.org/fhir/us/ecr/StructureDefinition/rr-documentreference']]/fhir:content/fhir:attachment) = 11"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
   </scenario>
</report>
