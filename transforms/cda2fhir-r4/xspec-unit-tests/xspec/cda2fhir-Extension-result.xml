<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.jenitennison.com/xslt/xspec"
        xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/cda2fhir-Extension.xspec"
        stylesheet="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/cda2fhir-Extension.xslt"
        date="2022-01-04T15:29:25.991365+10:00">
   <scenario id="scenario1"
             xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/cda2fhir-Extension.xspec">
      <label>Scenario for testing Travel History Address extension template with match 'cda:addr' and mode 'extension'</label>
      <input-wrap xmlns="">
         <x:context xmlns:cda="urn:hl7-org:v3"
                    xmlns:fhir="http://hl7.org/fhir"
                    xmlns:lcg="http://www.lantanagroup.com"
                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                    xmlns:x="http://www.jenitennison.com/xslt/xspec"
                    href="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/samples/cda/eICR-R3/eICR-CDA-001_R3.xml"
                    select="//cda:act[cda:templateId/@root = '2.16.840.1.113883.10.20.15.2.3.1'][cda:id/@root='45397b5c-e974-4cf1-8b19-e1555bd55701']/cda:participant/cda:participantRole/cda:addr"
                    mode="extension"/>
      </input-wrap>
      <result select="/element()">
         <content-wrap xmlns="">
            <extension xmlns="http://hl7.org/fhir"
                       url="http://hl7.org/fhir/us/ecr/StructureDefinition/travel-history-address-extension">
               <valueAddress>
                  <line value="1170 N Rancho Robles Rd"/>
                  <city value="Oracle"/>
                  <state value="AZ"/>
                  <postalCode value="8562"/>
                  <country value="US"/>
               </valueAddress>
            </extension>
         </content-wrap>
      </result>
      <test id="scenario1-expect1" successful="true">
         <label>There should be an extension.valueAddress.state='AZ'</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:extension/fhir:valueAddress/fhir:state[@value='AZ'])=1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
   </scenario>
   <scenario id="scenario2"
             xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/cda2fhir-Extension.xspec">
      <label>Scenario for testing determination of reportability (RR Composition) extension</label>
      <input-wrap xmlns="">
         <x:context xmlns:cda="urn:hl7-org:v3"
                    xmlns:fhir="http://hl7.org/fhir"
                    xmlns:lcg="http://www.lantanagroup.com"
                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                    xmlns:x="http://www.jenitennison.com/xslt/xspec"
                    href="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/samples/cda/RR-R1/RR-CDA-001_R1.xml"
                    select="//cda:observation[cda:templateId/@root = '2.16.840.1.113883.10.20.15.2.3.19']"
                    mode="extension"/>
      </input-wrap>
      <result select="/element()">
         <content-wrap xmlns="">
            <extension xmlns="http://hl7.org/fhir"
                       url="http://hl7.org/fhir/us/ecr/StructureDefinition/us-ph-determination-of-reportability-extension">
               <valueCodeableConcept>
                  <coding>
                     <system value="urn:oid:2.16.840.1.114222.4.5.274"/>
                     <code value="RRVS1"/>
                     <display value="Reportable"/>
                  </coding>
               </valueCodeableConcept>
            </extension>
         </content-wrap>
      </result>
      <test id="scenario2-expect1" successful="true">
         <label>There should be an extension.code='RRVS1'</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:extension/fhir:valueCodeableConcept/fhir:coding/fhir:code[@value='RRVS1'])=1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
   </scenario>
   <scenario id="scenario3"
             xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/cda2fhir-Extension.xspec">
      <label>Scenario for testing determination of reportability reason (RR Composition) extension</label>
      <input-wrap xmlns="">
         <x:context xmlns:cda="urn:hl7-org:v3"
                    xmlns:fhir="http://hl7.org/fhir"
                    xmlns:lcg="http://www.lantanagroup.com"
                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                    xmlns:x="http://www.jenitennison.com/xslt/xspec"
                    href="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/samples/cda/RR-R1/RR-CDA-001_R1.xml"
                    select="//cda:observation[cda:templateId/@root = '2.16.840.1.113883.10.20.15.2.3.26']"
                    mode="extension"/>
      </input-wrap>
      <result select="/element()">
         <content-wrap xmlns="">
            <extension xmlns="http://hl7.org/fhir"
                       url="http://hl7.org/fhir/us/ecr/StructureDefinition/us-ph-determination-of-reportability-reason-extension">
               <valueString value="Reason for determination of reportability"/>
            </extension>
         </content-wrap>
      </result>
      <test id="scenario3-expect1" successful="true">
         <label>There should be an extension.valueString='Reason for determination of reportability'</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:extension/fhir:valueString[@value='Reason for determination of reportability'])=1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
   </scenario>
   <scenario id="scenario4"
             xspec="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/transforms/cda2fhir-r4/xspec-unit-tests/cda2fhir-Extension.xspec">
      <label>Scenario for testing determination of reportability rule (RR C) extension</label>
      <input-wrap xmlns="">
         <x:context xmlns:cda="urn:hl7-org:v3"
                    xmlns:fhir="http://hl7.org/fhir"
                    xmlns:lcg="http://www.lantanagroup.com"
                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                    xmlns:x="http://www.jenitennison.com/xslt/xspec"
                    href="file:/C:/Users/minigrrl/Dropbox/12_SourceControl/GitHub/Lantana/FHIRTransforms/samples/cda/RR-R1/RR-CDA-001_R1.xml"
                    select="//cda:observation[cda:templateId/@root = '2.16.840.1.113883.10.20.15.2.3.27']"
                    mode="extension"/>
      </input-wrap>
      <result select="/element()">
         <content-wrap xmlns="">
            <extension xmlns="http://hl7.org/fhir"
                       url="http://hl7.org/fhir/us/ecr/StructureDefinition/us-ph-determination-of-reportability-rule-extension">
               <valueString value="Rule used in reportability determination"/>
            </extension>
         </content-wrap>
      </result>
      <test id="scenario4-expect1" successful="true">
         <label>There should be an extension.valueString='Rule used in reportability determination'</label>
         <expect-test-wrap xmlns="">
            <x:expect xmlns:cda="urn:hl7-org:v3"
                      xmlns:fhir="http://hl7.org/fhir"
                      xmlns:lcg="http://www.lantanagroup.com"
                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                      xmlns:x="http://www.jenitennison.com/xslt/xspec"
                      test="count(fhir:extension/fhir:valueString[@value='Rule used in reportability determination'])=1"/>
         </expect-test-wrap>
         <expect select="()"/>
      </test>
   </scenario>
</report>
