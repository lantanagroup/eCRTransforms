<?xml version="1.0" encoding="UTF-8"?>
<x:description xmlns:x="http://www.jenitennison.com/xslt/xspec" 
    xmlns:cda="urn:hl7-org:v3" 
    xmlns:fhir="http://hl7.org/fhir"
    xmlns:lcg="http://www.lantanagroup.com" stylesheet="../fhir2cda.xslt">
    
    <!--Scenario for testing template with match 'fhir:Encounter' and mode 'encounter' -->
    <x:scenario label="Scenario for testing fhir:section:EmergencyOutBreakInformation -> cda:section with xspec-test-files/XSPEC_eICR-FHIR-002_R2_1.xml">
        <x:context href="../../../samples/fhir/xspec-test-files/XSPEC_eICR-FHIR-002_R2_1.xml" />
        
        
        <x:expect label="Section templateId=2.16.840.1.113883.10.20.22.2.80 2020-04-01 should be correct" 
            test="//cda:component/cda:section/cda:templateId/@root='2.16.840.1.113883.10.20.22.2.80' and //cda:component/cda:section/cda:templateId/@extension='2020-04-01'"/>
        
        <x:expect label="Section templateId=2.16.840.1.113883.10.20.22.2.80 2018-04-01 should be correct" 
            test="//cda:component/cda:section/cda:templateId/@root='2.16.840.1.113883.10.20.22.2.80' and //cda:component/cda:section/cda:templateId/@extension='2018-04-01'"/>
        
        <x:expect label="Section code=90767-5 should be correct" 
            test="//cda:component/cda:section/cda:code/@code='90767-5' and //cda:component/cda:section/cda:code/@codeSystem='2.16.840.1.113883.6.1'"/>

        
        <x:expect label="Observation @classCode=OBS within entry should exist" 
            test="//cda:component/cda:section/cda:entry/cda:observation/@classCode='OBS'" />
        
        <x:expect label="Observation @moodCode=EVN within entry should exist" 
            test="//cda:component/cda:section/cda:entry/cda:observation/@moodCode='EVN'" />
             
        <x:expect label="Observation templateId = 2.16.840.1.113883.10.20.15.3.8 should be correct" 
            test="//cda:section/cda:entry/cda:observation/cda:templateId/@root='2.16.840.1.113883.10.20.15.3.8'"/> 
        
        <x:expect label="Observation templateId = 2.16.840.1.113883.10.20.22.4.293 2020-04-01 should be correct" 
            test="//cda:section/cda:entry/cda:observation/cda:templateId/@root='2.16.840.1.113883.10.20.22.4.293' and //cda:section/cda:entry/cda:observation/cda:templateId/@extension='2020-04-01'"/> 
        
        <x:expect label="Observation templateId = 2.16.840.1.113883.10.20.22.4.293 2018-04-01 should be correct" 
            test="//cda:section/cda:entry/cda:observation/cda:templateId/@root='2.16.840.1.113883.10.20.22.4.293' and //cda:section/cda:entry/cda:observation/cda:templateId/@extension='2018-04-01'"/> 
        
        <x:expect label="Id @nullFlavor=NI should have correct root and extension" 
            test="//cda:section/cda:entry/cda:observation/cda:id/@nullFlavor='NI'"/>
        
        <x:expect label="Observation statusCode=completed element should exist" test="count(//cda:section/cda:entry/cda:observation/cda:statusCode/@code='completed')=1"/>
        
        <x:expect label="Observation effectiveTime element should exist" test="count(//cda:section/cda:entry/cda:observation/cda:effectiveTime)=1"/>
        
        <x:expect label="Observation author element should exist" test="count(//cda:section/cda:entry/cda:observation/cda:author)=1"/>
        
        
    </x:scenario>
    
    
    
</x:description>
